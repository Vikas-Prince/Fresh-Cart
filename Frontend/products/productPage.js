const items = [
  {
    imagePath: "../Images/Fruits/f1.png",
    title: "Banana",
    price: 30,
    rating: 4.4,
    quantity: "1 Dozen",
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/f2.png",
    title: "Apple",
    price: 100,
    rating: 4.4,
    quantity: "1 Dozen",
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/kiwi.png",
    title: "Kiwi",
    price: 80,
    rating: 4.4,
    quantity: "1 Dozen",
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/mango.png",
    title: "Mango",
    quantity: "1 Dozen",
    price: 90,
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/pear.png",
    title: "Pear",
    price: 65,
    quantity: "1 Dozen",
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/pine.png",
    title: "Pine Apple",
    price: 25,
    quantity: "1 Unit",
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/promo.png",
    title: "Promogranate",
    price: 150,
    quantity: "1 Dozen",
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/jack.png",
    title: "Jack Fruit",
    price: 70,
    quantity: "1 unit",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/dates.png",
    title: "Dates",
    price: 70,
    quantity: "1kg",
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/peach.png",
    title: "Jack Fruit",
    price: 100,
    quantity: "1 Dozen",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/lyche.png",
    title: "Lychees",
    price: 70,
    quantity: "1kg",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/Star.png",
    title: "Star Fruit",
    price: 70,
    quantity: "1 Dozen",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/fig.png",
    title: "Fig Fruit",
    price: 100,
    quantity: "1 kg",
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/Cocunut.png",
    title: "Coconut",
    price: 20,
    quantity: "1 unit",
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/tamrind.png",
    title: "Tamarind",
    price: 55,
    quantity: "1Kg",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/plums.png",
    title: "Plum Fruit",
    price: 75,
    quantity: "1Kg",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/jack.png",
    title: "Jack Fruit",
    price: 70,
    quantity: "1 unit",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/goa.png",
    title: "Gauva",
    quantity: "1 Dozen",
    price: 55,
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/fruits/avacado.png",
    title: "Avacado",
    quantity: "1 Dozen",
    price: 60,
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/cherrys.png",
    title: "Cherry's",
    quantity: "1 Kg",
    price: 120,
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/dragon.png",
    title: "Dragon Fruit",
    quantity: "1 Dozen",
    price: 350,
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/water.png",
    title: "Water Melon",
    price: 80,
    quantity: "1 unit",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/orange.png",
    title: "Orange",
    quantity: "1 Dozen",
    price: 120,
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/f3.png",
    title: "Graphes",
    quantity: "1kg",
    price: 80,
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/fruits/custod.png",
    title: "Custard Apple",
    quantity: "1 Dozen",
    price: 250,
    rating: 4.4,
    category: "Fruits",
  },
  {
    imagePath: "../Images/Fruits/Chikko.png",
    title: "Chikoos",
    price: 100,
    quantity: "1 Dozen",
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/Fruits/f4.png",
    title: "Puppaya ",
    quantity: "1 unit",
    price: 25,
    rating: 4.4,
    category: "Fruits",
  },

  {
    imagePath: "../Images/vegetables/baby_cut_carrots.jpeg",
    title: "Bolthouse Farms Peeled Baby Cut Carrots, 1 lb Bag",
    price: 0.98,
    rating: 4.3,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/baby_yellow_potato.jpeg",
    title: "Baby Yellow Potatoes, 1.5 lb Bag",
    price: 3.47,
    rating: 4.1,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/broccoli.jpeg",
    title: "Broccoli Crowns",
    price: 1.11,
    rating: 4.6,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/cauliflower.jpeg",
    title: "Cauliflower",
    rating: 4.3,
    price: 4.3,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/cucumber.jpeg",
    title: "Cucumber",
    price: 0.5,
    category: "vegetables",
    rating: 4.1,
  },
  {
    imagePath: "../Images/vegetables/eggplant.jpeg",
    title: "Eggplant",
    category: "vegetables",
    price: 1.23,
    rating: 4.6,
  },
  {
    imagePath: "../Images/vegetables/fresh_celery.jpeg",
    title: "Fresh Celery",
    category: "vegetables",
    price: 0.88,
    rating: 4.4,
  },
  {
    imagePath: "../Images/vegetables/fresh_corn_cub.jpeg",
    title: "Fresh Corn on the Cob",
    category: "vegetables",
    price: 0.38,
    rating: 4.2,
  },
  {
    imagePath: "../Images/vegetables/fresh_ginger_root.jpeg",
    title: "Fresh Ginger Root",
    category: "vegetables",
    price: 1.98,
    rating: 4.2,
  },
  {
    imagePath: "../Images/vegetables/garlic.jpeg",
    title: "Garlic",
    price: 3.48,
    rating: 4.6,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/green_beans.jpeg",
    title: "Green Beans",
    price: 1.68,
    rating: 4.5,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/green_bell_pepper.jpeg",
    title: "Green Bell Pepper",
    price: 0.58,
    rating: 4.4,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/green_cabbage.png",
    title: "Green Cabbage",
    price: 1.74,
    rating: 4.2,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/green_onion_bunch.jpeg",
    title: "Green Onion, bunch",
    price: 0.5,
    rating: 4.4,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/iceberg_lettuce.jpeg",
    title: "Iceberg Lettuce",
    price: 1.53,
    rating: 4.2,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/marketside_chicken_ceasar_salad_bowl.jpeg",
    title: "Marketside Chicken Caesar Salad Bowl 6.25 oz",
    price: 2.98,
    rating: 4.4,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/marketside_organic_baby_spinach.jpeg",
    title: "Marketside Organic Baby Spinach, 5 oz",
    price: 2.56,
    rating: 4.1,
    category: "vegetables",
  },
  {
    imagePath: "../Images/vegetables/marketside_southwest_chooped_salad.jpeg",
    title: "Marketside Southwest Chopped Salad Kit, 10.3 oz",
    price: 2.98,
    rating: 4.3,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/marketside_sugar_snap_peas.jpeg",
    title: "Marketside Sugar Snap Peas, 8oz",
    price: 2.58,
    rating: 4.5,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/mixed_bell_pepper.jpeg",
    title: "Mixed Bell Peppers (Selection May Vary), 3 Count",
    price: 3.28,
    rating: 4.4,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/red_onion.jpeg",
    title: "Red Onions",
    price: 0.78,
    rating: 4.8,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/roma_tomato.jpeg",
    title: "Roma Tomatoes",
    price: 0.98,
    rating: 4.1,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/russet_potato.jpeg",
    title: "Simply Perfect Russet Potatoes, 5lb bag",
    price: 1.97,
    rating: 4.5,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/serrano_peppers.jpeg",
    title: "Serrano Peppers, approx. 8-12 per 0.25 lb",
    price: 0.27,
    rating: 4.4,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/spinach.jpeg",
    title: "Marketside Fresh Spinach, 10 oz",
    price: 1.37,
    rating: 4.6,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/sweet_potatoes.jpeg",
    title: "Sweet Potatoes",
    price: 0.54,
    rating: 4.8,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/tomatoes.jpeg",
    title: "Tomatoes on the Vine, avg 1.4 lb cluster",
    price: 1.48,
    rating: 4.1,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/white_mushroom.jpeg",
    title: "Fresh White Mushrooms, 8 oz",
    price: 1.38,
    rating: 4.5,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/whole_carrot.jpeg",
    title: "Whole Carrots, 1lb bag",
    price: 0.82,
    rating: 4.6,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/yellow_onion.jpeg",
    title: "Yellow Onions 3 lb Bag",
    price: 1.94,
    rating: 4.1,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/yellowOnions",
    title: "Yellow Squash, 1 Each",
    price: 1.94,
    rating: 4.4,
    category: "vegetables",
  },

  {
    imagePath: "../Images/vegetables/zucchini.jpeg",
    title: "Zucchini, 1 Each",
    price: 0.76,
    rating: 4.2,
    category: "vegetables",
  },
];

function createVegProduct(item) {
  const vegItem = $('<div class="thumbnail product-thumbnail col-sm-3"></div>');
  vegItem.append($('<a href="#"> <img src= "' + item.imagePath + '"></a>'));
  vegItem.append(
    $(
      '<div class="product-description"><div class="desc"></p> <p class="title">' +
        item.category +
        "/" +
        item.title +
        '</p><p class="price">&#x20B9; ' +
        item.price +
        "/<small>" +
        item.quantity +
        '</small></p></div> <div class="rating"> <p class="user-rating"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-star-half" viewBox="0 0 16 16" > <path d="M5.354 5.119 7.538.792A.52.52 0 0 1 8 .5c.183 0 .366.097.465.292l2.184 4.327 4.898.696A.54.54 0 0 1 16 6.32a.55.55 0 0 1-.17.445l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256a.5.5 0 0 1-.146.05c-.342.06-.668-.254-.6-.642l.83-4.73L.173 6.765a.55.55 0 0 1-.172-.403.6.6 0 0 1 .085-.302.51.51 0 0 1 .37-.245zM8 12.027a.5.5 0 0 1 .232.056l3.686 1.894-.694-3.957a.56.56 0 0 1 .162-.505l2.907-2.77-4.052-.576a.53.53 0 0 1-.393-.288L8.001 2.223 8 2.226z" /> </svg> ' +
        item.rating +
        "</p> </div>"
    )
  );

  vegItem.append(
    $(
      '<div class="cart-wishlist"> <center> <button onClick="addToCart()" class="cart-btn"> <svg xmlns="http://www.w3.org/2000/svg"  width="16"  height="16" fill="currentColor" class="bi bi-basket" viewBox="0 0 16 16" > <path d="M5.757 1.071a.5.5 0 0 1 .172.686L3.383 6h9.234L10.07 1.757a.5.5 0 1 1 .858-.514L13.783 6H15a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1v4.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 13.5V9a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h1.217L5.07 1.243a.5.5 0 0 1 .686-.172zM2 9v4.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V9zM1 7v1h14V7zm3 3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 4 10m2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 6 10m2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 8 10m2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5m2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5" /></svg> Add to Cart </button>    <button class="wishlist-btn" onClick="addToList()"> <svg        xmlns="http://www.w3.org/2000/svg" width="16"        height="16" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16" > <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314" /> </svg> Wishlist </button> </center> </div>'
    )
  );

  $(".products").append(vegItem);
}

$("#searchInput").on("input", function () {
  const keyword = $(this).val().trim();
  displayFilteredProducts(keyword);
});

function displayFilteredProducts(keyword) {
  $(".products").empty();
  const filteredItems = items.filter((item) =>
    item.title.toLowerCase().includes(keyword.toLowerCase())
  );

  if (filteredItems.length > 0) {
    filteredItems.forEach((item) => createVegProduct(item));
  } else {
    $(".products").html(
      "<center><h3>Sorry No products are found ðŸ˜• </h3></center>"
    );
  }
}

function filterAndRenderItems() {
  const selectedCategories = [];
  $("input[name='filter-check']:checked").each(function () {
    selectedCategories.push($(this).parent().text().trim());
  });

  const filteredItems =
    selectedCategories.length === 0
      ? items
      : items.filter(function (item) {
          return selectedCategories.includes(item.category);
        });

  $(".products").empty();

  $.each(filteredItems, function (index, item) {
    createVegProduct(item);
  });
}

$("input[name='filter-check']").on("change", function () {
  filterAndRenderItems();
});

filterAndRenderItems();

const itemList = $(".products");

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Shuffle the items array
items = shuffle(items);

$.each(items, function (index, items) {
  itemList.append(createVegProduct(items));
});

// $("#searchInput").on("input", function () {
//   const keyword = $(this).val().trim();
//   displayFilteredProducts(keyword);
// });

// add to cart

$(".cart-click").on("click", function () {
  $(".filter-product-section").hide();
  $("#cart-section").removeClass("hidden");
});

function addToCart() {
  const productDiv = $(event.target).closest(".thumbnail");
  const imagePath = productDiv.find("img").attr("src");
  const title = productDiv.find(".title").text();
  const quantity = productDiv.find("small").text();
  const price = parseFloat(productDiv.find(".price").text().replace("â‚¹", ""));

  const item = {
    imagePath: imagePath,
    title: title,
    price: price,
    quantity: quantity,
  };

  $.ajax({
    url: "/saveToCart",
    type: "POST",
    data: JSON.stringify(item),
    contentType: "application/json",
    success: function (response) {
      console.log("Item added to cart:", item);
      $("#responseMessage").text(response);
      $(".toast").toast("show");
      alert(response);
    },
    error: function (xhr, status, error) {
      console.error("Error adding item to cart:", error);
    },
  });
}

function addToList() {
  const productDiv = $(event.target).closest(".thumbnail");
  const imagePath = productDiv.find("img").attr("src");
  const title = productDiv.find(".title").text();
  const quantity = productDiv.find("small").text();
  const price = parseFloat(productDiv.find(".price").text().replace("â‚¹", ""));

  const item = {
    imagePath: imagePath,
    title: title,
    price: price,
    quantity: quantity,
  };

  $.ajax({
    url: "/saveToList",
    type: "POST",
    data: JSON.stringify(item),
    contentType: "application/json",
    success: function (response) {
      console.log("Item added to cart:", item);
      $("#responseMessage").text(response);
      $(".toast").toast("show");
      alert(response);
    },
    error: function (xhr, status, error) {
      console.error("Error adding item to cart:", error);
    },
  });
}
